# SUNSTUDIO é›†æˆæ–¹æ¡ˆ

## é¡¹ç›®æ¦‚è¿°

### SUNSTUDIO æ˜¯ä»€ä¹ˆï¼Ÿ
SUNSTUDIO æ˜¯ä¸€ä¸ªåŸºäº Google AI Studio çš„**å¯è§†åŒ–èŠ‚ç‚¹ç¼–è¾‘å™¨**ï¼Œä¸“æ³¨äºå¤šæ¨¡æ€ AI å†…å®¹ç”Ÿæˆå·¥ä½œæµã€‚å®ƒæä¾›äº†ä¸€ä¸ªç±»ä¼¼ ComfyUI/Blender Nodes çš„å¯è§†åŒ–ç¼–ç¨‹ç•Œé¢ï¼Œè®©ç”¨æˆ·é€šè¿‡æ‹–æ‹½å’Œè¿æ¥èŠ‚ç‚¹æ¥åˆ›å»ºå¤æ‚çš„ AI ç”Ÿæˆç®¡é“ã€‚

### æ ¸å¿ƒèƒ½åŠ›
1. **èŠ‚ç‚¹ç³»ç»Ÿ** - æ”¯æŒ 6 ç§èŠ‚ç‚¹ç±»å‹ï¼š
   - PROMPT_INPUT: æ–‡æœ¬æç¤ºè¾“å…¥
   - IMAGE_GENERATOR: å›¾åƒç”Ÿæˆ
   - VIDEO_GENERATOR: è§†é¢‘ç”Ÿæˆï¼ˆå«å¤šç§æ¨¡å¼ï¼‰
   - VIDEO_ANALYZER: è§†é¢‘åˆ†æ
   - IMAGE_EDITOR: å›¾åƒç¼–è¾‘
   - AUDIO_GENERATOR: éŸ³é¢‘ç”Ÿæˆ

2. **å¯è§†åŒ–ç¼–è¾‘å™¨**
   - æ‹–æ‹½å¼èŠ‚ç‚¹ç¼–è¾‘
   - èŠ‚ç‚¹é—´è¿æ¥å’Œæ•°æ®æµ
   - åˆ†ç»„å’Œå·¥ä½œæµç®¡ç†
   - æ™ºèƒ½å¸ƒå±€å’Œç¢°æ’æ£€æµ‹

3. **ä¸“ä¸šå·¥å…·**
   - SmartSequenceDock: æ™ºèƒ½åºåˆ—ç”Ÿæˆï¼ˆå›¾åƒè½¬åœºåŠ¨ç”»ï¼‰
   - SonicStudio: éŸ³é¢‘å·¥ä½œå®¤ï¼ˆéŸ³ä¹/è¯­éŸ³ç”Ÿæˆï¼‰
   - ImageCropper: å›¾åƒè£å‰ªå·¥å…·
   - SketchEditor: è‰å›¾ç¼–è¾‘å™¨
   - AssistantPanel: AI åŠ©æ‰‹é¢æ¿

4. **å·¥ä½œæµç®¡ç†**
   - ä¿å­˜/åŠ è½½å·¥ä½œæµ
   - æ¨¡æ¿ç³»ç»Ÿ
   - æœ¬åœ°å­˜å‚¨æŒä¹…åŒ–

---

## å½“å‰æŠ€æœ¯æ ˆåˆ†æ

### SUNSTUDIOï¼ˆåŸé¡¹ç›®ï¼‰
```json
{
  "æ¡†æ¶": "React 19 + TypeScript",
  "æ„å»ºå·¥å…·": "Vite 6.2",
  "åŒ…ç®¡ç†å™¨": "npm (æœ‰ package-lock.json)",
  "AI SDK": "@google/genai (Gemini)",
  "UI åº“": "lucide-react (å›¾æ ‡)",
  "æ ·å¼": "å†…è”æ ·å¼ + Tailwind CSS ç±»"
}
```

### Agent Platformï¼ˆç›®æ ‡é¡¹ç›®ï¼‰
```json
{
  "æ¡†æ¶": "Next.js 16 (App Router) + React 19",
  "åŒ…ç®¡ç†å™¨": "Bun",
  "AI API": "Claude API (é€šè¿‡ç¬¬ä¸‰æ–¹ä»£ç†)",
  "æ ·å¼": "CSS Modules",
  "æ¶æ„": "Workspace + Tabs æ¨¡å—åŒ–è®¾è®¡"
}
```

### å…¼å®¹æ€§åˆ†æ
âœ… **å®Œå…¨å…¼å®¹**ï¼š
- React 19 ç‰ˆæœ¬ä¸€è‡´
- TypeScript æ”¯æŒ
- ç°ä»£ ES æ¨¡å—è¯­æ³•

âš ï¸ **éœ€è¦è°ƒæ•´**ï¼š
- Vite â†’ Next.js App Router
- npm â†’ Bun
- Gemini API â†’ Claude APIï¼ˆæˆ–ç»Ÿä¸€ API å±‚ï¼‰
- å¯¼å…¥è·¯å¾„è°ƒæ•´
- å®¢æˆ·ç«¯ç»„ä»¶æ ‡è®°

---

## é›†æˆæ¶æ„è®¾è®¡

### 1. æ¨¡å—å®šä½
SUNSTUDIO ä½œä¸ºç¬¬å››ä¸ªæ ¸å¿ƒæ¨¡å— **"Studio"** é›†æˆåˆ° Agent Platformï¼š

| æ¨¡å— | å®šä½ | è·¯ç”± |
|------|------|------|
| Agent | æ™ºèƒ½å¯¹è¯ | `/workspace?tab=agent` |
| Ground | å·¥å…·å¸‚åœº | `/workspace?tab=ground` |
| Library | ä½œå“åº“ | `/workspace?tab=library` |
| **Studio** | å·¥ä½œæµç¼–è¾‘å™¨ | `/workspace?tab=studio` |

### 2. ç›®å½•ç»“æ„

```
web/src/
â”œâ”€â”€ workspace/
â”‚   â”œâ”€â”€ tabs/
â”‚   â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”œâ”€â”€ ground/
â”‚   â”‚   â”œâ”€â”€ library/
â”‚   â”‚   â””â”€â”€ studio/                    # ğŸ†• æ–°å¢ SUNSTUDIO æ¨¡å—
â”‚   â”‚       â”œâ”€â”€ StudioTab.js           # ä¸»å…¥å£ï¼ˆæ›¿ä»£åŸ App.tsxï¼‰
â”‚   â”‚       â”œâ”€â”€ StudioTab.module.css   # å…¨å±€æ ·å¼
â”‚   â”‚       â”œâ”€â”€ components/            # è¿ç§»æ‰€æœ‰ç»„ä»¶
â”‚   â”‚       â”‚   â”œâ”€â”€ Node.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ SidebarDock.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ SmartSequenceDock.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ SonicStudio.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ AssistantPanel.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ ImageCropper.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ SketchEditor.jsx
â”‚   â”‚       â”‚   â”œâ”€â”€ SettingsModal.jsx
â”‚   â”‚       â”‚   â””â”€â”€ VideoNodeModules.jsx
â”‚   â”‚       â”œâ”€â”€ services/              # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚       â”‚   â”œâ”€â”€ geminiService.js   # é‡å‘½åä¸º aiService.js
â”‚   â”‚       â”‚   â”œâ”€â”€ videoStrategies.js
â”‚   â”‚       â”‚   â””â”€â”€ storage.js
â”‚   â”‚       â”œâ”€â”€ types.ts               # ç±»å‹å®šä¹‰
â”‚   â”‚       â””â”€â”€ constants.js           # å¸¸é‡é…ç½®
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ tabs.js                    # ğŸ”§ æ›´æ–°ï¼šæ·»åŠ  studio æ ‡ç­¾
â”‚   â””â”€â”€ contexts/
â”‚       â””â”€â”€ WorkspaceContext.js
â”œâ”€â”€ app/
â”‚   â””â”€â”€ api/                           # ğŸ†• æ–°å¢ API è·¯ç”±
â”‚       â””â”€â”€ studio/
â”‚           â”œâ”€â”€ generate-image/
â”‚           â”œâ”€â”€ generate-video/
â”‚           â”œâ”€â”€ generate-audio/
â”‚           â””â”€â”€ analyze-video/
â””â”€â”€ components/
    â””â”€â”€ layout/
        â””â”€â”€ Navbar.js                  # ğŸ”§ æ›´æ–°ï¼šè‡ªåŠ¨è¯†åˆ«æ–°æ ‡ç­¾
```

---

## è¿ç§»æ­¥éª¤è¯¦è§£

### Phase 1: é…ç½®å’Œè·¯ç”±ï¼ˆåŸºç¡€æ¶æ„ï¼‰

#### 1.1 æ›´æ–°æ ‡ç­¾é…ç½®
**æ–‡ä»¶**: `src/workspace/config/tabs.js`

```javascript
export const WORKSPACE_TABS = [
  { id: 'agent', label: 'Agent' },
  { id: 'ground', label: 'Ground' },
  { id: 'library', label: 'Library' },
  { id: 'studio', label: 'Studio' }, // ğŸ†• æ–°å¢
];
```

#### 1.2 åˆ›å»º Studio Tab ç›®å½•
```bash
mkdir -p src/workspace/tabs/studio/{components,services}
```

---

### Phase 2: ç»„ä»¶è¿ç§»ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

#### 2.1 ä¸»å…¥å£ç»„ä»¶è¿ç§»
å°† `SUNSTUDIO/App.tsx` â†’ `src/workspace/tabs/studio/StudioTab.js`

**å…³é”®è°ƒæ•´**ï¼š
```jsx
// âœ… æ·»åŠ å®¢æˆ·ç«¯ç»„ä»¶æ ‡è®°
"use client";

// âœ… è°ƒæ•´å¯¼å…¥è·¯å¾„
import { Node } from './components/Node';
import { generateImageFromText } from './services/aiService';

// âœ… ä½¿ç”¨ CSS Modules
import styles from './StudioTab.module.css';

// âœ… å¯¼å‡ºä¸º Next.js é¡µé¢ç»„ä»¶
export default function StudioTab() {
  // ... åŸæœ‰é€»è¾‘ä¿æŒä¸å˜
}
```

#### 2.2 ç»„ä»¶æ–‡ä»¶è¿ç§»æ¸…å•
```bash
# ç›´æ¥å¤åˆ¶æ‰€æœ‰ç»„ä»¶åˆ°æ–°ç›®å½•
cp SUNSTUDIO/components/*.tsx src/workspace/tabs/studio/components/

# æ‰¹é‡æ·»åŠ  'use client' æŒ‡ä»¤ï¼ˆæ‰€æœ‰ç»„ä»¶éƒ½éœ€è¦ï¼‰
for file in src/workspace/tabs/studio/components/*.tsx; do
  sed -i '' '1s/^/"use client";\n\n/' "$file"
done
```

#### 2.3 æ ·å¼å¤„ç†
SUNSTUDIO ä½¿ç”¨å†…è”æ ·å¼ï¼Œéœ€è¦æå–åˆ° CSS Modulesï¼š

**ç­–ç•¥**ï¼š
1. ä¿ç•™ Tailwind ç±»åï¼ˆé¡¹ç›®å·²æ”¯æŒï¼‰
2. æå–å¤æ‚å†…è”æ ·å¼åˆ° `.module.css`
3. ä½¿ç”¨ CSS å˜é‡ç»Ÿä¸€ä¸»é¢˜è‰²

---

### Phase 3: API é›†æˆï¼ˆå…³é”®æ”¹é€ ï¼‰

#### 3.1 ç»Ÿä¸€ AI æœåŠ¡å±‚
å°† `SUNSTUDIO/services/geminiService.ts` é‡æ„ä¸ºé€šç”¨ AI æœåŠ¡ï¼š

**æ–‡ä»¶**: `src/workspace/tabs/studio/services/aiService.js`

```javascript
/**
 * ç»Ÿä¸€ AI æœåŠ¡å±‚ - æ”¯æŒå¤šç§ AI æ¨¡å‹
 * é»˜è®¤ä½¿ç”¨ Claude APIï¼Œå¯æ‰©å±•æ”¯æŒ Gemini/OpenAI ç­‰
 */

// Claude API é…ç½®ï¼ˆå¤ç”¨ç°æœ‰ç¯å¢ƒå˜é‡ï¼‰
const CLAUDE_API_URL = process.env.NEXT_PUBLIC_CLAUDE_THIRD_URL;
const CLAUDE_API_KEY = process.env.NEXT_PUBLIC_CLAUDE_THIRD_KEY;

/**
 * å›¾åƒç”Ÿæˆï¼ˆé€šè¿‡ Next.js API Route è°ƒç”¨ï¼‰
 */
export async function generateImageFromText(prompt, options = {}) {
  try {
    const response = await fetch('/api/studio/generate-image', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        prompt,
        imageCount: options.imageCount || 1
      })
    });

    if (!response.ok) throw new Error('å›¾åƒç”Ÿæˆå¤±è´¥');
    return await response.json();
  } catch (error) {
    console.error('generateImageFromText error:', error);
    throw error;
  }
}

// ... å…¶ä»– AI åŠŸèƒ½ç±»ä¼¼å¤„ç†
```

#### 3.2 åˆ›å»º API Routes
**æ–‡ä»¶**: `src/app/api/studio/generate-image/route.js`

```javascript
import { NextResponse } from 'next/server';

export async function POST(request) {
  try {
    const { prompt, imageCount = 1 } = await request.json();

    // è°ƒç”¨å®é™…çš„ AI æœåŠ¡ï¼ˆClaude/Gemini/Stability AI ç­‰ï¼‰
    const images = await callImageGenerationAPI(prompt, imageCount);

    return NextResponse.json({ images });
  } catch (error) {
    return NextResponse.json(
      { error: error.message },
      { status: 500 }
    );
  }
}

// å®é™…çš„ AI è°ƒç”¨é€»è¾‘ï¼ˆå¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ä¸åŒçš„ AI æœåŠ¡ï¼‰
async function callImageGenerationAPI(prompt, count) {
  // TODO: é›†æˆå®é™…çš„å›¾åƒç”Ÿæˆ API
  // å¯é€‰æ–¹æ¡ˆï¼š
  // 1. Stability AI (SDXL)
  // 2. DALL-E 3
  // 3. Midjourney API
  // 4. æœ¬åœ° Stable Diffusion

  throw new Error('å›¾åƒç”Ÿæˆ API å¾…é…ç½®');
}
```

---

### Phase 4: ä¾èµ–ç®¡ç†

#### 4.1 å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨ Bunï¼‰
```bash
cd web

# æ·»åŠ  SUNSTUDIO ç‰¹æœ‰ä¾èµ–
bun add lucide-react

# å¦‚æœä¿ç•™ Gemini æ”¯æŒ
bun add @google/genai

# å¯é€‰ï¼šæ·»åŠ å…¶ä»– AI SDK
# bun add openai  # OpenAI SDK
# bun add @anthropic-ai/sdk  # Claude SDK
```

#### 4.2 æ›´æ–° package.json
```json
{
  "dependencies": {
    "lucide-react": "^0.555.0",
    "@google/genai": "^1.30.0"
  }
}
```

---

## æŠ€æœ¯å€ºåŠ¡å’Œä¼˜åŒ–å»ºè®®

### ç«‹å³å¤„ç†ï¼ˆMVP å¿…éœ€ï¼‰
- [ ] å°†æ‰€æœ‰ç»„ä»¶æ ‡è®°ä¸ºå®¢æˆ·ç«¯ç»„ä»¶ï¼ˆ`'use client'`ï¼‰
- [ ] è°ƒæ•´æ‰€æœ‰å¯¼å…¥è·¯å¾„ä¸º Next.js åˆ«åï¼ˆ`@/`ï¼‰
- [ ] åˆ›å»ºç»Ÿä¸€çš„ AI æœåŠ¡ API Routes
- [ ] æµ‹è¯•èŠ‚ç‚¹æ‹–æ‹½å’Œè¿æ¥åŠŸèƒ½
- [ ] éªŒè¯æœ¬åœ°å­˜å‚¨åœ¨ Next.js ä¸­çš„è¡Œä¸º

### åç»­ä¼˜åŒ–ï¼ˆæ¸è¿›å¼æ”¹è¿›ï¼‰
1. **æ€§èƒ½ä¼˜åŒ–**
   - ä½¿ç”¨ React.memo ä¼˜åŒ–èŠ‚ç‚¹ç»„ä»¶
   - è™šæ‹ŸåŒ–é•¿åˆ—è¡¨ï¼ˆå·¥ä½œæµåˆ—è¡¨ï¼‰
   - æ‡’åŠ è½½å¤§å‹ç»„ä»¶ï¼ˆSonicStudioï¼‰

2. **ç”¨æˆ·ä½“éªŒ**
   - æ·»åŠ é”®ç›˜å¿«æ·é”®è¯´æ˜
   - å·¥ä½œæµæ¨¡æ¿åº“
   - æ’¤é”€/é‡åšåŠŸèƒ½

3. **æ•°æ®æŒä¹…åŒ–**
   - ä» localStorage è¿ç§»åˆ°æ•°æ®åº“
   - è·¨è®¾å¤‡åŒæ­¥å·¥ä½œæµ
   - ç‰ˆæœ¬å†å²è®°å½•

4. **AI èƒ½åŠ›æ‰©å±•**
   - æ”¯æŒæ›´å¤š AI æ¨¡å‹é€‰æ‹©
   - æ¨¡å‹å‚æ•°å¯é…ç½®åŒ–
   - Prompt æ¨¡æ¿åº“

---

## é£é™©è¯„ä¼°

### é«˜é£é™©é¡¹
| é£é™©ç‚¹ | å½±å“ | ç¼“è§£æªæ–½ |
|--------|------|----------|
| API å…¼å®¹æ€§ | æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨ | å…ˆå®ç° Mock APIï¼Œæ¸è¿›å¼é›†æˆçœŸå® AI |
| æ ·å¼å†²çª | UI æ˜¾ç¤ºå¼‚å¸¸ | ä½¿ç”¨ CSS Modules éš”ç¦»æ ·å¼ |
| æ€§èƒ½é—®é¢˜ | èŠ‚ç‚¹æ•°é‡å¤šæ—¶å¡é¡¿ | å¯ç”¨ React Profiler ç›‘æ§ï¼ŒæŒ‰éœ€ä¼˜åŒ– |

### ä¸­é£é™©é¡¹
| é£é™©ç‚¹ | å½±å“ | ç¼“è§£æªæ–½ |
|--------|------|----------|
| å­˜å‚¨è¿ç§» | ç°æœ‰å·¥ä½œæµä¸¢å¤± | æä¾›å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½ |
| ä¾èµ–å†²çª | æ„å»ºå¤±è´¥ | é”å®šä¾èµ–ç‰ˆæœ¬ï¼Œä½¿ç”¨ Bun çš„ lockfile |

---

## æµ‹è¯•è®¡åˆ’

### å•å…ƒæµ‹è¯•
- [ ] èŠ‚ç‚¹åˆ›å»º/åˆ é™¤/è¿æ¥é€»è¾‘
- [ ] å·¥ä½œæµåºåˆ—åŒ–/ååºåˆ—åŒ–
- [ ] AI æœåŠ¡è°ƒç”¨ Mock

### é›†æˆæµ‹è¯•
- [ ] å®Œæ•´å·¥ä½œæµæ‰§è¡Œï¼ˆPrompt â†’ Image â†’ Videoï¼‰
- [ ] å·¥ä½œæµä¿å­˜/åŠ è½½
- [ ] å¤šç§èŠ‚ç‚¹ç±»å‹ç»„åˆ

### E2E æµ‹è¯•
- [ ] ä»ç©ºç™½ç”»å¸ƒåˆ›å»ºå®Œæ•´å·¥ä½œæµ
- [ ] è·¨æ ‡ç­¾åˆ‡æ¢çŠ¶æ€ä¿æŒ
- [ ] æµè§ˆå™¨åˆ·æ–°åæ¢å¤å·¥ä½œæµ

---

## æˆåŠŸæŒ‡æ ‡

### åŠŸèƒ½å®Œæ•´æ€§
- âœ… æ‰€æœ‰ 6 ç§èŠ‚ç‚¹ç±»å‹å¯æ­£å¸¸åˆ›å»ºå’Œé…ç½®
- âœ… èŠ‚ç‚¹è¿æ¥å’Œæ•°æ®æµæ­£ç¡®ä¼ é€’
- âœ… å·¥ä½œæµå¯ä¿å­˜å’Œæ¢å¤
- âœ… AI ç”ŸæˆåŠŸèƒ½æ­£å¸¸å·¥ä½œï¼ˆè‡³å°‘æ”¯æŒå›¾åƒç”Ÿæˆï¼‰

### ç”¨æˆ·ä½“éªŒ
- âœ… å¯¼èˆªæ æ–°å¢ "Studio" å…¥å£
- âœ… æ ‡ç­¾åˆ‡æ¢æµç•…ï¼ŒçŠ¶æ€ä¿æŒ
- âœ… æ‹–æ‹½æ“ä½œæ— æ˜æ˜¾å»¶è¿Ÿï¼ˆ<100msï¼‰
- âœ… å“åº”å¼å¸ƒå±€é€‚é…ä¸åŒå±å¹•

### æŠ€æœ¯è´¨é‡
- âœ… æ— æ§åˆ¶å°é”™è¯¯æˆ–è­¦å‘Š
- âœ… æ‰“åŒ…ä½“ç§¯å¢é•¿ <2MBï¼ˆgzip åï¼‰
- âœ… é¦–æ¬¡æ¸²æŸ“æ—¶é—´ <1s
- âœ… ä»£ç ç¬¦åˆ ESLint è§„èŒƒ

---

## æ—¶é—´ä¼°ç®—

| é˜¶æ®µ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| Phase 1: é…ç½®å’Œè·¯ç”± | 0.5 å¤© | P0 |
| Phase 2: ç»„ä»¶è¿ç§» | 2 å¤© | P0 |
| Phase 3: API é›†æˆï¼ˆMockï¼‰ | 1 å¤© | P0 |
| Phase 4: ä¾èµ–ç®¡ç† | 0.5 å¤© | P0 |
| **MVP æ€»è®¡** | **4 å¤©** | - |
| Phase 5: çœŸå® AI é›†æˆ | 2 å¤© | P1 |
| Phase 6: ä¼˜åŒ–å’Œæµ‹è¯• | 1 å¤© | P1 |
| **å®Œæ•´ç‰ˆæ€»è®¡** | **7 å¤©** | - |

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼ˆä»Šå¤©ï¼‰
   - [x] åˆ†æ SUNSTUDIO æ¶æ„ âœ…
   - [x] ç¼–å†™é›†æˆæ–¹æ¡ˆæ–‡æ¡£ âœ…
   - [ ] æ›´æ–°æ ‡ç­¾é…ç½®
   - [ ] åˆ›å»º Studio ç›®å½•ç»“æ„

2. **æœ¬å‘¨å®Œæˆ**ï¼ˆMVPï¼‰
   - [ ] è¿ç§»æ ¸å¿ƒç»„ä»¶
   - [ ] å®ç° Mock API
   - [ ] åŸºç¡€åŠŸèƒ½æµ‹è¯•

3. **ä¸‹å‘¨ä¼˜åŒ–**ï¼ˆå®Œæ•´ç‰ˆï¼‰
   - [ ] é›†æˆçœŸå® AI æœåŠ¡
   - [ ] æ€§èƒ½ä¼˜åŒ–
   - [ ] å®Œå–„æ–‡æ¡£
